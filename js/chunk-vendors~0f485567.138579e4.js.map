{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/@firebase/analytics/dist/index.esm.js"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperty","Object","defineProperty","enumerable","configurable","writable","GtagCommand","EventName","GA_FID_KEY","ORIGIN_KEY","FETCH_TIMEOUT_MILLIS","DYNAMIC_CONFIG_URL","GTAG_URL","logEvent","gtagFunction","initializationPromise","eventName","eventParams","options","measurementId","params","_a","label","global","EVENT","sent","setCurrentScreen","screenName","SET","CONFIG","update","setUserId","id","setUserProperties","properties","flatProperties","_i","_b","keys","length","setAnalyticsCollectionEnabled","enabled","window","logger","insertScriptTag","dataLayerName","script","document","createElement","src","async","head","appendChild","getOrCreateDataLayer","dataLayer","Array","isArray","gtagOnConfig","gtagCore","initializationPromisesMap","dynamicConfigPromisesList","measurementIdToAppId","gtagParams","correspondingAppId","dynamicConfigResults","foundConfig","e_1","trys","push","all","find","config","appId","gtagOnEvent","initializationPromisesToWaitFor","gaSendToList","_loop_1","gaSendToList_1","sendToId","state_1","e_2","values","wrapGtag","gtagWrapper","command","idOrNameOrParams","e_3","wrapOrCreateGtag","gtagFunctionName","_args","wrappedGtag","findGtagScriptOnPage","scriptTags","getElementsByTagName","tag","includes","ERRORS","ERROR_FACTORY","LONG_RETRY_FACTOR","BASE_INTERVAL_MILLIS","RetryData","throttleMetadata","intervalMillis","getThrottleMetadata","setThrottleMetadata","metadata","deleteThrottleMetadata","defaultRetryData","getHeaders","apiKey","Headers","Accept","fetchDynamicConfig","appFields","request","appUrl","response","errorMessage","jsonResponse","method","headers","replace","fetch","status","json","message","create","httpStatus","responseMessage","fetchDynamicConfigWithRetry","app","retryData","timeoutMillis","signal","_this","backoffCount","throttleEndTimeMillis","Date","now","AnalyticsAbortSignal","setTimeout","abort","attemptFetchDynamicConfigWithRetry","backoffMillis","setAbortableTimeout","warn","isRetriableError","Number","debug","Math","max","timeout","addEventListener","clearTimeout","e","listeners","listener","forEach","validateIndexedDB","errorInfo","initializeIds","installations","dynamicConfigPromise","fidPromise","dynamicConfig","fid","configProperties","_c","catch","envIsValid","getId","gtagCoreFunction","wrappedGtagFunction","gtagName","globalInitDone","resetGlobalVars","newGlobalInitDone","newInitializationPromisesMap","newDynamicPromises","getGlobalVars","settings","warnOnBrowserContextMismatch","mismatchedEnvMessages","details","map","index","join","factory","analyticsInstance","INTERNAL","delete","name","version","ANALYTICS_TYPE","registerAnalytics","instance","internalFactory","container","analytics","getProvider","getImmediate","reason","registerComponent","setServiceProps","isSupported","registerVersion","isDBOpenable"],"mappings":"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","file":"js/chunk-vendors~0f485567.138579e4.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import { __awaiter, __generator, __assign } from 'tslib';\nimport firebase from '@firebase/app';\nimport '@firebase/installations';\nimport { Logger } from '@firebase/logger';\nimport { ErrorFactory, calculateBackoffMillis, FirebaseError, validateIndexedDBOpenable, isIndexedDBAvailable, isBrowserExtension, areCookiesEnabled } from '@firebase/util';\nimport { Component } from '@firebase/component';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n// Key to attach FID to in gtag params.\r\nvar GA_FID_KEY = 'firebase_id';\r\nvar ORIGIN_KEY = 'origin';\r\nvar FETCH_TIMEOUT_MILLIS = 60 * 1000;\r\nvar DYNAMIC_CONFIG_URL = 'https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig';\r\nvar GTAG_URL = 'https://www.googletagmanager.com/gtag/js';\r\nvar GtagCommand;\r\n(function (GtagCommand) {\r\n    GtagCommand[\"EVENT\"] = \"event\";\r\n    GtagCommand[\"SET\"] = \"set\";\r\n    GtagCommand[\"CONFIG\"] = \"config\";\r\n})(GtagCommand || (GtagCommand = {}));\r\n/*\r\n * Officially recommended event names for gtag.js\r\n * Any other string is also allowed.\r\n */\r\nvar EventName;\r\n(function (EventName) {\r\n    EventName[\"ADD_SHIPPING_INFO\"] = \"add_shipping_info\";\r\n    EventName[\"ADD_PAYMENT_INFO\"] = \"add_payment_info\";\r\n    EventName[\"ADD_TO_CART\"] = \"add_to_cart\";\r\n    EventName[\"ADD_TO_WISHLIST\"] = \"add_to_wishlist\";\r\n    EventName[\"BEGIN_CHECKOUT\"] = \"begin_checkout\";\r\n    /** @deprecated */\r\n    EventName[\"CHECKOUT_PROGRESS\"] = \"checkout_progress\";\r\n    EventName[\"EXCEPTION\"] = \"exception\";\r\n    EventName[\"GENERATE_LEAD\"] = \"generate_lead\";\r\n    EventName[\"LOGIN\"] = \"login\";\r\n    EventName[\"PAGE_VIEW\"] = \"page_view\";\r\n    EventName[\"PURCHASE\"] = \"purchase\";\r\n    EventName[\"REFUND\"] = \"refund\";\r\n    EventName[\"REMOVE_FROM_CART\"] = \"remove_from_cart\";\r\n    EventName[\"SCREEN_VIEW\"] = \"screen_view\";\r\n    EventName[\"SEARCH\"] = \"search\";\r\n    EventName[\"SELECT_CONTENT\"] = \"select_content\";\r\n    EventName[\"SELECT_ITEM\"] = \"select_item\";\r\n    EventName[\"SELECT_PROMOTION\"] = \"select_promotion\";\r\n    /** @deprecated */\r\n    EventName[\"SET_CHECKOUT_OPTION\"] = \"set_checkout_option\";\r\n    EventName[\"SHARE\"] = \"share\";\r\n    EventName[\"SIGN_UP\"] = \"sign_up\";\r\n    EventName[\"TIMING_COMPLETE\"] = \"timing_complete\";\r\n    EventName[\"VIEW_CART\"] = \"view_cart\";\r\n    EventName[\"VIEW_ITEM\"] = \"view_item\";\r\n    EventName[\"VIEW_ITEM_LIST\"] = \"view_item_list\";\r\n    EventName[\"VIEW_PROMOTION\"] = \"view_promotion\";\r\n    EventName[\"VIEW_SEARCH_RESULTS\"] = \"view_search_results\";\r\n})(EventName || (EventName = {}));\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Logs an analytics event through the Firebase SDK.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param eventName Google Analytics event name, choose from standard list or use a custom string.\r\n * @param eventParams Analytics event parameters.\r\n */\r\nfunction logEvent(gtagFunction, initializationPromise, eventName, eventParams, options) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var measurementId, params;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!(options && options.global)) return [3 /*break*/, 1];\r\n                    gtagFunction(GtagCommand.EVENT, eventName, eventParams);\r\n                    return [2 /*return*/];\r\n                case 1: return [4 /*yield*/, initializationPromise];\r\n                case 2:\r\n                    measurementId = _a.sent();\r\n                    params = __assign(__assign({}, eventParams), { 'send_to': measurementId });\r\n                    gtagFunction(GtagCommand.EVENT, eventName, params);\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Set screen_name parameter for this Google Analytics ID.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param screenName Screen name string to set.\r\n */\r\nfunction setCurrentScreen(gtagFunction, initializationPromise, screenName, options) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var measurementId;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!(options && options.global)) return [3 /*break*/, 1];\r\n                    gtagFunction(GtagCommand.SET, { 'screen_name': screenName });\r\n                    return [2 /*return*/, Promise.resolve()];\r\n                case 1: return [4 /*yield*/, initializationPromise];\r\n                case 2:\r\n                    measurementId = _a.sent();\r\n                    gtagFunction(GtagCommand.CONFIG, measurementId, {\r\n                        update: true,\r\n                        'screen_name': screenName\r\n                    });\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Set user_id parameter for this Google Analytics ID.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param id User ID string to set\r\n */\r\nfunction setUserId(gtagFunction, initializationPromise, id, options) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var measurementId;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!(options && options.global)) return [3 /*break*/, 1];\r\n                    gtagFunction(GtagCommand.SET, { 'user_id': id });\r\n                    return [2 /*return*/, Promise.resolve()];\r\n                case 1: return [4 /*yield*/, initializationPromise];\r\n                case 2:\r\n                    measurementId = _a.sent();\r\n                    gtagFunction(GtagCommand.CONFIG, measurementId, {\r\n                        update: true,\r\n                        'user_id': id\r\n                    });\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Set all other user properties other than user_id and screen_name.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param properties Map of user properties to set\r\n */\r\nfunction setUserProperties(gtagFunction, initializationPromise, properties, options) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var flatProperties, _i, _a, key, measurementId;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    if (!(options && options.global)) return [3 /*break*/, 1];\r\n                    flatProperties = {};\r\n                    for (_i = 0, _a = Object.keys(properties); _i < _a.length; _i++) {\r\n                        key = _a[_i];\r\n                        // use dot notation for merge behavior in gtag.js\r\n                        flatProperties[\"user_properties.\" + key] = properties[key];\r\n                    }\r\n                    gtagFunction(GtagCommand.SET, flatProperties);\r\n                    return [2 /*return*/, Promise.resolve()];\r\n                case 1: return [4 /*yield*/, initializationPromise];\r\n                case 2:\r\n                    measurementId = _b.sent();\r\n                    gtagFunction(GtagCommand.CONFIG, measurementId, {\r\n                        update: true,\r\n                        'user_properties': properties\r\n                    });\r\n                    _b.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Set whether collection is enabled for this ID.\r\n *\r\n * @param enabled If true, collection is enabled for this ID.\r\n */\r\nfunction setAnalyticsCollectionEnabled(initializationPromise, enabled) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var measurementId;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, initializationPromise];\r\n                case 1:\r\n                    measurementId = _a.sent();\r\n                    window[\"ga-disable-\" + measurementId] = !enabled;\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar logger = new Logger('@firebase/analytics');\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Inserts gtag script tag into the page to asynchronously download gtag.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\").\r\n */\r\nfunction insertScriptTag(dataLayerName) {\r\n    var script = document.createElement('script');\r\n    // We are not providing an analyticsId in the URL because it would trigger a `page_view`\r\n    // without fid. We will initialize ga-id using gtag (config) command together with fid.\r\n    script.src = GTAG_URL + \"?l=\" + dataLayerName;\r\n    script.async = true;\r\n    document.head.appendChild(script);\r\n}\r\n/**\r\n * Get reference to, or create, global datalayer.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\").\r\n */\r\nfunction getOrCreateDataLayer(dataLayerName) {\r\n    // Check for existing dataLayer and create if needed.\r\n    var dataLayer = [];\r\n    if (Array.isArray(window[dataLayerName])) {\r\n        dataLayer = window[dataLayerName];\r\n    }\r\n    else {\r\n        window[dataLayerName] = dataLayer;\r\n    }\r\n    return dataLayer;\r\n}\r\n/**\r\n * Wrapped gtag logic when gtag is called with 'config' command.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n * @param measurementId GA Measurement ID to set config for.\r\n * @param gtagParams Gtag config params to set.\r\n */\r\nfunction gtagOnConfig(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, measurementId, gtagParams) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var correspondingAppId, dynamicConfigResults, foundConfig, e_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    correspondingAppId = measurementIdToAppId[measurementId];\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 7, , 8]);\r\n                    if (!correspondingAppId) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, initializationPromisesMap[correspondingAppId]];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 6];\r\n                case 3: return [4 /*yield*/, Promise.all(dynamicConfigPromisesList)];\r\n                case 4:\r\n                    dynamicConfigResults = _a.sent();\r\n                    foundConfig = dynamicConfigResults.find(function (config) { return config.measurementId === measurementId; });\r\n                    if (!foundConfig) return [3 /*break*/, 6];\r\n                    return [4 /*yield*/, initializationPromisesMap[foundConfig.appId]];\r\n                case 5:\r\n                    _a.sent();\r\n                    _a.label = 6;\r\n                case 6: return [3 /*break*/, 8];\r\n                case 7:\r\n                    e_1 = _a.sent();\r\n                    logger.error(e_1);\r\n                    return [3 /*break*/, 8];\r\n                case 8:\r\n                    gtagCore(GtagCommand.CONFIG, measurementId, gtagParams);\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Wrapped gtag logic when gtag is called with 'event' command.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementId GA Measurement ID to log event to.\r\n * @param gtagParams Params to log with this event.\r\n */\r\nfunction gtagOnEvent(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementId, gtagParams) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var initializationPromisesToWaitFor, gaSendToList, dynamicConfigResults, _loop_1, _i, gaSendToList_1, sendToId, state_1, e_2;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    _a.trys.push([0, 4, , 5]);\r\n                    initializationPromisesToWaitFor = [];\r\n                    if (!(gtagParams && gtagParams['send_to'])) return [3 /*break*/, 2];\r\n                    gaSendToList = gtagParams['send_to'];\r\n                    // Make it an array if is isn't, so it can be dealt with the same way.\r\n                    if (!Array.isArray(gaSendToList)) {\r\n                        gaSendToList = [gaSendToList];\r\n                    }\r\n                    return [4 /*yield*/, Promise.all(dynamicConfigPromisesList)];\r\n                case 1:\r\n                    dynamicConfigResults = _a.sent();\r\n                    _loop_1 = function (sendToId) {\r\n                        // Any fetched dynamic measurement ID that matches this 'send_to' ID\r\n                        var foundConfig = dynamicConfigResults.find(function (config) { return config.measurementId === sendToId; });\r\n                        var initializationPromise = foundConfig && initializationPromisesMap[foundConfig.appId];\r\n                        if (initializationPromise) {\r\n                            initializationPromisesToWaitFor.push(initializationPromise);\r\n                        }\r\n                        else {\r\n                            // Found an item in 'send_to' that is not associated\r\n                            // directly with an FID, possibly a group.  Empty this array,\r\n                            // exit the loop early, and let it get populated below.\r\n                            initializationPromisesToWaitFor = [];\r\n                            return \"break\";\r\n                        }\r\n                    };\r\n                    for (_i = 0, gaSendToList_1 = gaSendToList; _i < gaSendToList_1.length; _i++) {\r\n                        sendToId = gaSendToList_1[_i];\r\n                        state_1 = _loop_1(sendToId);\r\n                        if (state_1 === \"break\")\r\n                            break;\r\n                    }\r\n                    _a.label = 2;\r\n                case 2:\r\n                    // This will be unpopulated if there was no 'send_to' field , or\r\n                    // if not all entries in the 'send_to' field could be mapped to\r\n                    // a FID. In these cases, wait on all pending initialization promises.\r\n                    if (initializationPromisesToWaitFor.length === 0) {\r\n                        initializationPromisesToWaitFor = Object.values(initializationPromisesMap);\r\n                    }\r\n                    // Run core gtag function with args after all relevant initialization\r\n                    // promises have been resolved.\r\n                    return [4 /*yield*/, Promise.all(initializationPromisesToWaitFor)];\r\n                case 3:\r\n                    // Run core gtag function with args after all relevant initialization\r\n                    // promises have been resolved.\r\n                    _a.sent();\r\n                    // Workaround for http://b/141370449 - third argument cannot be undefined.\r\n                    gtagCore(GtagCommand.EVENT, measurementId, gtagParams || {});\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    e_2 = _a.sent();\r\n                    logger.error(e_2);\r\n                    return [3 /*break*/, 5];\r\n                case 5: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Wraps a standard gtag function with extra code to wait for completion of\r\n * relevant initialization promises before sending requests.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n */\r\nfunction wrapGtag(gtagCore, \r\n/**\r\n * Allows wrapped gtag calls to wait on whichever intialization promises are required,\r\n * depending on the contents of the gtag params' `send_to` field, if any.\r\n */\r\ninitializationPromisesMap, \r\n/**\r\n * Wrapped gtag calls sometimes require all dynamic config fetches to have returned\r\n * before determining what initialization promises (which include FIDs) to wait for.\r\n */\r\ndynamicConfigPromisesList, \r\n/**\r\n * Wrapped gtag config calls can narrow down which initialization promise (with FID)\r\n * to wait for if the measurementId is already fetched, by getting the corresponding appId,\r\n * which is the key for the initialization promises map.\r\n */\r\nmeasurementIdToAppId) {\r\n    /**\r\n     * Wrapper around gtag that ensures FID is sent with gtag calls.\r\n     * @param command Gtag command type.\r\n     * @param idOrNameOrParams Measurement ID if command is EVENT/CONFIG, params if command is SET.\r\n     * @param gtagParams Params if event is EVENT/CONFIG.\r\n     */\r\n    function gtagWrapper(command, idOrNameOrParams, gtagParams) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var e_3;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, 6, , 7]);\r\n                        if (!(command === GtagCommand.EVENT)) return [3 /*break*/, 2];\r\n                        // If EVENT, second arg must be measurementId.\r\n                        return [4 /*yield*/, gtagOnEvent(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, idOrNameOrParams, gtagParams)];\r\n                    case 1:\r\n                        // If EVENT, second arg must be measurementId.\r\n                        _a.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 2:\r\n                        if (!(command === GtagCommand.CONFIG)) return [3 /*break*/, 4];\r\n                        // If CONFIG, second arg must be measurementId.\r\n                        return [4 /*yield*/, gtagOnConfig(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, idOrNameOrParams, gtagParams)];\r\n                    case 3:\r\n                        // If CONFIG, second arg must be measurementId.\r\n                        _a.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        // If SET, second arg must be params.\r\n                        gtagCore(GtagCommand.SET, idOrNameOrParams);\r\n                        _a.label = 5;\r\n                    case 5: return [3 /*break*/, 7];\r\n                    case 6:\r\n                        e_3 = _a.sent();\r\n                        logger.error(e_3);\r\n                        return [3 /*break*/, 7];\r\n                    case 7: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    return gtagWrapper;\r\n}\r\n/**\r\n * Creates global gtag function or wraps existing one if found.\r\n * This wrapped function attaches Firebase instance ID (FID) to gtag 'config' and\r\n * 'event' calls that belong to the GAID associated with this Firebase instance.\r\n *\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n * @param dataLayerName Name of global GA datalayer array.\r\n * @param gtagFunctionName Name of global gtag function (\"gtag\" if not user-specified).\r\n */\r\nfunction wrapOrCreateGtag(initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, dataLayerName, gtagFunctionName) {\r\n    // Create a basic core gtag function\r\n    var gtagCore = function () {\r\n        var _args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            _args[_i] = arguments[_i];\r\n        }\r\n        // Must push IArguments object, not an array.\r\n        window[dataLayerName].push(arguments);\r\n    };\r\n    // Replace it with existing one if found\r\n    if (window[gtagFunctionName] &&\r\n        typeof window[gtagFunctionName] === 'function') {\r\n        // @ts-ignore\r\n        gtagCore = window[gtagFunctionName];\r\n    }\r\n    window[gtagFunctionName] = wrapGtag(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId);\r\n    return {\r\n        gtagCore: gtagCore,\r\n        wrappedGtag: window[gtagFunctionName]\r\n    };\r\n}\r\n/**\r\n * Returns first script tag in DOM matching our gtag url pattern.\r\n */\r\nfunction findGtagScriptOnPage() {\r\n    var scriptTags = window.document.getElementsByTagName('script');\r\n    for (var _i = 0, _a = Object.values(scriptTags); _i < _a.length; _i++) {\r\n        var tag = _a[_i];\r\n        if (tag.src && tag.src.includes(GTAG_URL)) {\r\n            return tag;\r\n        }\r\n    }\r\n    return null;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar _a;\r\nvar ERRORS = (_a = {},\r\n    _a[\"already-exists\" /* ALREADY_EXISTS */] = 'A Firebase Analytics instance with the appId {$id} ' +\r\n        ' already exists. ' +\r\n        'Only one Firebase Analytics instance can be created for each appId.',\r\n    _a[\"already-initialized\" /* ALREADY_INITIALIZED */] = 'Firebase Analytics has already been initialized.' +\r\n        'settings() must be called before initializing any Analytics instance' +\r\n        'or it will have no effect.',\r\n    _a[\"interop-component-reg-failed\" /* INTEROP_COMPONENT_REG_FAILED */] = 'Firebase Analytics Interop Component failed to instantiate: {$reason}',\r\n    _a[\"invalid-analytics-context\" /* INVALID_ANALYTICS_CONTEXT */] = 'Firebase Analytics is not supported in this environment. ' +\r\n        'Wrap initialization of analytics in analytics.isSupported() ' +\r\n        'to prevent initialization in unsupported environments. Details: {$errorInfo}',\r\n    _a[\"indexeddb-unavailable\" /* INDEXEDDB_UNAVAILABLE */] = 'IndexedDB unavailable or restricted in this environment. ' +\r\n        'Wrap initialization of analytics in analytics.isSupported() ' +\r\n        'to prevent initialization in unsupported environments. Details: {$errorInfo}',\r\n    _a[\"fetch-throttle\" /* FETCH_THROTTLE */] = 'The config fetch request timed out while in an exponential backoff state.' +\r\n        ' Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',\r\n    _a[\"config-fetch-failed\" /* CONFIG_FETCH_FAILED */] = 'Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}',\r\n    _a[\"no-api-key\" /* NO_API_KEY */] = 'The \"apiKey\" field is empty in the local Firebase config. Firebase Analytics requires this field to' +\r\n        'contain a valid API key.',\r\n    _a[\"no-app-id\" /* NO_APP_ID */] = 'The \"appId\" field is empty in the local Firebase config. Firebase Analytics requires this field to' +\r\n        'contain a valid app ID.',\r\n    _a);\r\nvar ERROR_FACTORY = new ErrorFactory('analytics', 'Analytics', ERRORS);\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Backoff factor for 503 errors, which we want to be conservative about\r\n * to avoid overloading servers. Each retry interval will be\r\n * BASE_INTERVAL_MILLIS * LONG_RETRY_FACTOR ^ retryCount, so the second one\r\n * will be ~30 seconds (with fuzzing).\r\n */\r\nvar LONG_RETRY_FACTOR = 30;\r\n/**\r\n * Base wait interval to multiplied by backoffFactor^backoffCount.\r\n */\r\nvar BASE_INTERVAL_MILLIS = 1000;\r\n/**\r\n * Stubbable retry data storage class.\r\n */\r\nvar RetryData = /** @class */ (function () {\r\n    function RetryData(throttleMetadata, intervalMillis) {\r\n        if (throttleMetadata === void 0) { throttleMetadata = {}; }\r\n        if (intervalMillis === void 0) { intervalMillis = BASE_INTERVAL_MILLIS; }\r\n        this.throttleMetadata = throttleMetadata;\r\n        this.intervalMillis = intervalMillis;\r\n    }\r\n    RetryData.prototype.getThrottleMetadata = function (appId) {\r\n        return this.throttleMetadata[appId];\r\n    };\r\n    RetryData.prototype.setThrottleMetadata = function (appId, metadata) {\r\n        this.throttleMetadata[appId] = metadata;\r\n    };\r\n    RetryData.prototype.deleteThrottleMetadata = function (appId) {\r\n        delete this.throttleMetadata[appId];\r\n    };\r\n    return RetryData;\r\n}());\r\nvar defaultRetryData = new RetryData();\r\n/**\r\n * Set GET request headers.\r\n * @param apiKey App API key.\r\n */\r\nfunction getHeaders(apiKey) {\r\n    return new Headers({\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\n/**\r\n * Fetches dynamic config from backend.\r\n * @param app Firebase app to fetch config for.\r\n */\r\nfunction fetchDynamicConfig(appFields) {\r\n    var _a;\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var appId, apiKey, request, appUrl, response, errorMessage, jsonResponse, _ignored_1;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    appId = appFields.appId, apiKey = appFields.apiKey;\r\n                    request = {\r\n                        method: 'GET',\r\n                        headers: getHeaders(apiKey)\r\n                    };\r\n                    appUrl = DYNAMIC_CONFIG_URL.replace('{app-id}', appId);\r\n                    return [4 /*yield*/, fetch(appUrl, request)];\r\n                case 1:\r\n                    response = _b.sent();\r\n                    if (!(response.status !== 200 && response.status !== 304)) return [3 /*break*/, 6];\r\n                    errorMessage = '';\r\n                    _b.label = 2;\r\n                case 2:\r\n                    _b.trys.push([2, 4, , 5]);\r\n                    return [4 /*yield*/, response.json()];\r\n                case 3:\r\n                    jsonResponse = (_b.sent());\r\n                    if ((_a = jsonResponse.error) === null || _a === void 0 ? void 0 : _a.message) {\r\n                        errorMessage = jsonResponse.error.message;\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    _ignored_1 = _b.sent();\r\n                    return [3 /*break*/, 5];\r\n                case 5: throw ERROR_FACTORY.create(\"config-fetch-failed\" /* CONFIG_FETCH_FAILED */, {\r\n                    httpStatus: response.status,\r\n                    responseMessage: errorMessage\r\n                });\r\n                case 6: return [2 /*return*/, response.json()];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Fetches dynamic config from backend, retrying if failed.\r\n * @param app Firebase app to fetch config for.\r\n */\r\nfunction fetchDynamicConfigWithRetry(app, \r\n// retryData and timeoutMillis are parameterized to allow passing a different value for testing.\r\nretryData, timeoutMillis) {\r\n    if (retryData === void 0) { retryData = defaultRetryData; }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var _a, appId, apiKey, measurementId, throttleMetadata, signal;\r\n        var _this = this;\r\n        return __generator(this, function (_b) {\r\n            _a = app.options, appId = _a.appId, apiKey = _a.apiKey, measurementId = _a.measurementId;\r\n            if (!appId) {\r\n                throw ERROR_FACTORY.create(\"no-app-id\" /* NO_APP_ID */);\r\n            }\r\n            if (!apiKey) {\r\n                if (measurementId) {\r\n                    return [2 /*return*/, {\r\n                            measurementId: measurementId,\r\n                            appId: appId\r\n                        }];\r\n                }\r\n                throw ERROR_FACTORY.create(\"no-api-key\" /* NO_API_KEY */);\r\n            }\r\n            throttleMetadata = retryData.getThrottleMetadata(appId) || {\r\n                backoffCount: 0,\r\n                throttleEndTimeMillis: Date.now()\r\n            };\r\n            signal = new AnalyticsAbortSignal();\r\n            setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {\r\n                return __generator(this, function (_a) {\r\n                    // Note a very low delay, eg < 10ms, can elapse before listeners are initialized.\r\n                    signal.abort();\r\n                    return [2 /*return*/];\r\n                });\r\n            }); }, timeoutMillis !== undefined ? timeoutMillis : FETCH_TIMEOUT_MILLIS);\r\n            return [2 /*return*/, attemptFetchDynamicConfigWithRetry({ appId: appId, apiKey: apiKey, measurementId: measurementId }, throttleMetadata, signal, retryData)];\r\n        });\r\n    });\r\n}\r\n/**\r\n * Runs one retry attempt.\r\n * @param appFields Necessary app config fields.\r\n * @param throttleMetadata Ongoing metadata to determine throttling times.\r\n * @param signal Abort signal.\r\n */\r\nfunction attemptFetchDynamicConfigWithRetry(appFields, _a, signal, retryData // for testing\r\n) {\r\n    var throttleEndTimeMillis = _a.throttleEndTimeMillis, backoffCount = _a.backoffCount;\r\n    if (retryData === void 0) { retryData = defaultRetryData; }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var appId, measurementId, e_1, response, e_2, backoffMillis, throttleMetadata;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0:\r\n                    appId = appFields.appId, measurementId = appFields.measurementId;\r\n                    _b.label = 1;\r\n                case 1:\r\n                    _b.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, setAbortableTimeout(signal, throttleEndTimeMillis)];\r\n                case 2:\r\n                    _b.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    e_1 = _b.sent();\r\n                    if (measurementId) {\r\n                        logger.warn(\"Timed out fetching this Firebase app's measurement ID from the server.\" +\r\n                            (\" Falling back to the measurement ID \" + measurementId) +\r\n                            (\" provided in the \\\"measurementId\\\" field in the local Firebase config. [\" + e_1.message + \"]\"));\r\n                        return [2 /*return*/, { appId: appId, measurementId: measurementId }];\r\n                    }\r\n                    throw e_1;\r\n                case 4:\r\n                    _b.trys.push([4, 6, , 7]);\r\n                    return [4 /*yield*/, fetchDynamicConfig(appFields)];\r\n                case 5:\r\n                    response = _b.sent();\r\n                    // Note the SDK only clears throttle state if response is success or non-retriable.\r\n                    retryData.deleteThrottleMetadata(appId);\r\n                    return [2 /*return*/, response];\r\n                case 6:\r\n                    e_2 = _b.sent();\r\n                    if (!isRetriableError(e_2)) {\r\n                        retryData.deleteThrottleMetadata(appId);\r\n                        if (measurementId) {\r\n                            logger.warn(\"Failed to fetch this Firebase app's measurement ID from the server.\" +\r\n                                (\" Falling back to the measurement ID \" + measurementId) +\r\n                                (\" provided in the \\\"measurementId\\\" field in the local Firebase config. [\" + e_2.message + \"]\"));\r\n                            return [2 /*return*/, { appId: appId, measurementId: measurementId }];\r\n                        }\r\n                        else {\r\n                            throw e_2;\r\n                        }\r\n                    }\r\n                    backoffMillis = Number(e_2.httpStatus) === 503\r\n                        ? calculateBackoffMillis(backoffCount, retryData.intervalMillis, LONG_RETRY_FACTOR)\r\n                        : calculateBackoffMillis(backoffCount, retryData.intervalMillis);\r\n                    throttleMetadata = {\r\n                        throttleEndTimeMillis: Date.now() + backoffMillis,\r\n                        backoffCount: backoffCount + 1\r\n                    };\r\n                    // Persists state.\r\n                    retryData.setThrottleMetadata(appId, throttleMetadata);\r\n                    logger.debug(\"Calling attemptFetch again in \" + backoffMillis + \" millis\");\r\n                    return [2 /*return*/, attemptFetchDynamicConfigWithRetry(appFields, throttleMetadata, signal, retryData)];\r\n                case 7: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Supports waiting on a backoff by:\r\n *\r\n * <ul>\r\n *   <li>Promisifying setTimeout, so we can set a timeout in our Promise chain</li>\r\n *   <li>Listening on a signal bus for abort events, just like the Fetch API</li>\r\n *   <li>Failing in the same way the Fetch API fails, so timing out a live request and a throttled\r\n *       request appear the same.</li>\r\n * </ul>\r\n *\r\n * <p>Visible for testing.\r\n */\r\nfunction setAbortableTimeout(signal, throttleEndTimeMillis) {\r\n    return new Promise(function (resolve, reject) {\r\n        // Derives backoff from given end time, normalizing negative numbers to zero.\r\n        var backoffMillis = Math.max(throttleEndTimeMillis - Date.now(), 0);\r\n        var timeout = setTimeout(resolve, backoffMillis);\r\n        // Adds listener, rather than sets onabort, because signal is a shared object.\r\n        signal.addEventListener(function () {\r\n            clearTimeout(timeout);\r\n            // If the request completes before this timeout, the rejection has no effect.\r\n            reject(ERROR_FACTORY.create(\"fetch-throttle\" /* FETCH_THROTTLE */, {\r\n                throttleEndTimeMillis: throttleEndTimeMillis\r\n            }));\r\n        });\r\n    });\r\n}\r\n/**\r\n * Returns true if the {@link Error} indicates a fetch request may succeed later.\r\n */\r\nfunction isRetriableError(e) {\r\n    if (!(e instanceof FirebaseError)) {\r\n        return false;\r\n    }\r\n    // Uses string index defined by ErrorData, which FirebaseError implements.\r\n    var httpStatus = Number(e['httpStatus']);\r\n    return (httpStatus === 429 ||\r\n        httpStatus === 500 ||\r\n        httpStatus === 503 ||\r\n        httpStatus === 504);\r\n}\r\n/**\r\n * Shims a minimal AbortSignal (copied from Remote Config).\r\n *\r\n * <p>AbortController's AbortSignal conveniently decouples fetch timeout logic from other aspects\r\n * of networking, such as retries. Firebase doesn't use AbortController enough to justify a\r\n * polyfill recommendation, like we do with the Fetch API, but this minimal shim can easily be\r\n * swapped out if/when we do.\r\n */\r\nvar AnalyticsAbortSignal = /** @class */ (function () {\r\n    function AnalyticsAbortSignal() {\r\n        this.listeners = [];\r\n    }\r\n    AnalyticsAbortSignal.prototype.addEventListener = function (listener) {\r\n        this.listeners.push(listener);\r\n    };\r\n    AnalyticsAbortSignal.prototype.abort = function () {\r\n        this.listeners.forEach(function (listener) { return listener(); });\r\n    };\r\n    return AnalyticsAbortSignal;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction validateIndexedDB() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var e_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (!!isIndexedDBAvailable()) return [3 /*break*/, 1];\r\n                    logger.warn(ERROR_FACTORY.create(\"indexeddb-unavailable\" /* INDEXEDDB_UNAVAILABLE */, {\r\n                        errorInfo: 'IndexedDB is not available in this environment.'\r\n                    }).message);\r\n                    return [2 /*return*/, false];\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, validateIndexedDBOpenable()];\r\n                case 2:\r\n                    _a.sent();\r\n                    return [3 /*break*/, 4];\r\n                case 3:\r\n                    e_1 = _a.sent();\r\n                    logger.warn(ERROR_FACTORY.create(\"indexeddb-unavailable\" /* INDEXEDDB_UNAVAILABLE */, {\r\n                        errorInfo: e_1\r\n                    }).message);\r\n                    return [2 /*return*/, false];\r\n                case 4: return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\n/**\r\n * Initialize the analytics instance in gtag.js by calling config command with fid.\r\n *\r\n * NOTE: We combine analytics initialization and setting fid together because we want fid to be\r\n * part of the `page_view` event that's sent during the initialization\r\n * @param app Firebase app\r\n * @param gtagCore The gtag function that's not wrapped.\r\n * @param dynamicConfigPromisesList Array of all dynamic config promises.\r\n * @param measurementIdToAppId Maps measurementID to appID.\r\n * @param installations FirebaseInstallations instance.\r\n *\r\n * @returns Measurement ID.\r\n */\r\nfunction initializeIds(app, dynamicConfigPromisesList, measurementIdToAppId, installations, gtagCore) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var dynamicConfigPromise, fidPromise, _a, dynamicConfig, fid, configProperties;\r\n        var _b;\r\n        return __generator(this, function (_c) {\r\n            switch (_c.label) {\r\n                case 0:\r\n                    dynamicConfigPromise = fetchDynamicConfigWithRetry(app);\r\n                    // Once fetched, map measurementIds to appId, for ease of lookup in wrapped gtag function.\r\n                    dynamicConfigPromise\r\n                        .then(function (config) {\r\n                        measurementIdToAppId[config.measurementId] = config.appId;\r\n                        if (app.options.measurementId &&\r\n                            config.measurementId !== app.options.measurementId) {\r\n                            logger.warn(\"The measurement ID in the local Firebase config (\" + app.options.measurementId + \")\" +\r\n                                (\" does not match the measurement ID fetched from the server (\" + config.measurementId + \").\") +\r\n                                \" To ensure analytics events are always sent to the correct Analytics property,\" +\r\n                                \" update the\" +\r\n                                \" measurement ID field in the local config or remove it from the local config.\");\r\n                        }\r\n                    })\r\n                        .catch(function (e) { return logger.error(e); });\r\n                    // Add to list to track state of all dynamic config promises.\r\n                    dynamicConfigPromisesList.push(dynamicConfigPromise);\r\n                    fidPromise = validateIndexedDB().then(function (envIsValid) {\r\n                        if (envIsValid) {\r\n                            return installations.getId();\r\n                        }\r\n                        else {\r\n                            return undefined;\r\n                        }\r\n                    });\r\n                    return [4 /*yield*/, Promise.all([\r\n                            dynamicConfigPromise,\r\n                            fidPromise\r\n                        ])];\r\n                case 1:\r\n                    _a = _c.sent(), dynamicConfig = _a[0], fid = _a[1];\r\n                    // This command initializes gtag.js and only needs to be called once for the entire web app,\r\n                    // but since it is idempotent, we can call it multiple times.\r\n                    // We keep it together with other initialization logic for better code structure.\r\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                    gtagCore('js', new Date());\r\n                    configProperties = (_b = {},\r\n                        // guard against developers accidentally setting properties with prefix `firebase_`\r\n                        _b[ORIGIN_KEY] = 'firebase',\r\n                        _b.update = true,\r\n                        _b);\r\n                    if (fid != null) {\r\n                        configProperties[GA_FID_KEY] = fid;\r\n                    }\r\n                    // It should be the first config command called on this GA-ID\r\n                    // Initialize this GA-ID and set FID on it using the gtag config API.\r\n                    gtagCore(GtagCommand.CONFIG, dynamicConfig.measurementId, configProperties);\r\n                    return [2 /*return*/, dynamicConfig.measurementId];\r\n            }\r\n        });\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Maps appId to full initialization promise. Wrapped gtag calls must wait on\r\n * all or some of these, depending on the call's `send_to` param and the status\r\n * of the dynamic config fetches (see below).\r\n */\r\nvar initializationPromisesMap = {};\r\n/**\r\n * List of dynamic config fetch promises. In certain cases, wrapped gtag calls\r\n * wait on all these to be complete in order to determine if it can selectively\r\n * wait for only certain initialization (FID) promises or if it must wait for all.\r\n */\r\nvar dynamicConfigPromisesList = [];\r\n/**\r\n * Maps fetched measurementIds to appId. Populated when the app's dynamic config\r\n * fetch completes. If already populated, gtag config calls can use this to\r\n * selectively wait for only this app's initialization promise (FID) instead of all\r\n * initialization promises.\r\n */\r\nvar measurementIdToAppId = {};\r\n/**\r\n * Name for window global data layer array used by GA: defaults to 'dataLayer'.\r\n */\r\nvar dataLayerName = 'dataLayer';\r\n/**\r\n * Name for window global gtag function used by GA: defaults to 'gtag'.\r\n */\r\nvar gtagName = 'gtag';\r\n/**\r\n * Reproduction of standard gtag function or reference to existing\r\n * gtag function on window object.\r\n */\r\nvar gtagCoreFunction;\r\n/**\r\n * Wrapper around gtag function that ensures FID is sent with all\r\n * relevant event and config calls.\r\n */\r\nvar wrappedGtagFunction;\r\n/**\r\n * Flag to ensure page initialization steps (creation or wrapping of\r\n * dataLayer and gtag script) are only run once per page load.\r\n */\r\nvar globalInitDone = false;\r\n/**\r\n * For testing\r\n */\r\nfunction resetGlobalVars(newGlobalInitDone, newInitializationPromisesMap, newDynamicPromises) {\r\n    if (newGlobalInitDone === void 0) { newGlobalInitDone = false; }\r\n    if (newInitializationPromisesMap === void 0) { newInitializationPromisesMap = {}; }\r\n    if (newDynamicPromises === void 0) { newDynamicPromises = []; }\r\n    globalInitDone = newGlobalInitDone;\r\n    initializationPromisesMap = newInitializationPromisesMap;\r\n    dynamicConfigPromisesList = newDynamicPromises;\r\n    dataLayerName = 'dataLayer';\r\n    gtagName = 'gtag';\r\n}\r\n/**\r\n * For testing\r\n */\r\nfunction getGlobalVars() {\r\n    return {\r\n        initializationPromisesMap: initializationPromisesMap,\r\n        dynamicConfigPromisesList: dynamicConfigPromisesList\r\n    };\r\n}\r\n/**\r\n * This must be run before calling firebase.analytics() or it won't\r\n * have any effect.\r\n * @param options Custom gtag and dataLayer names.\r\n */\r\nfunction settings(options) {\r\n    if (globalInitDone) {\r\n        throw ERROR_FACTORY.create(\"already-initialized\" /* ALREADY_INITIALIZED */);\r\n    }\r\n    if (options.dataLayerName) {\r\n        dataLayerName = options.dataLayerName;\r\n    }\r\n    if (options.gtagName) {\r\n        gtagName = options.gtagName;\r\n    }\r\n}\r\n/**\r\n * Returns true if no environment mismatch is found.\r\n * If environment mismatches are found, throws an INVALID_ANALYTICS_CONTEXT\r\n * error that also lists details for each mismatch found.\r\n */\r\nfunction warnOnBrowserContextMismatch() {\r\n    var mismatchedEnvMessages = [];\r\n    if (isBrowserExtension()) {\r\n        mismatchedEnvMessages.push('This is a browser extension environment.');\r\n    }\r\n    if (!areCookiesEnabled()) {\r\n        mismatchedEnvMessages.push('Cookies are not available.');\r\n    }\r\n    if (mismatchedEnvMessages.length > 0) {\r\n        var details = mismatchedEnvMessages\r\n            .map(function (message, index) { return \"(\" + (index + 1) + \") \" + message; })\r\n            .join(' ');\r\n        var err = ERROR_FACTORY.create(\"invalid-analytics-context\" /* INVALID_ANALYTICS_CONTEXT */, {\r\n            errorInfo: details\r\n        });\r\n        logger.warn(err.message);\r\n    }\r\n}\r\nfunction factory(app, installations) {\r\n    warnOnBrowserContextMismatch();\r\n    var appId = app.options.appId;\r\n    if (!appId) {\r\n        throw ERROR_FACTORY.create(\"no-app-id\" /* NO_APP_ID */);\r\n    }\r\n    if (!app.options.apiKey) {\r\n        if (app.options.measurementId) {\r\n            logger.warn(\"The \\\"apiKey\\\" field is empty in the local Firebase config. This is needed to fetch the latest\" +\r\n                (\" measurement ID for this Firebase app. Falling back to the measurement ID \" + app.options.measurementId) +\r\n                \" provided in the \\\"measurementId\\\" field in the local Firebase config.\");\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"no-api-key\" /* NO_API_KEY */);\r\n        }\r\n    }\r\n    if (initializationPromisesMap[appId] != null) {\r\n        throw ERROR_FACTORY.create(\"already-exists\" /* ALREADY_EXISTS */, {\r\n            id: appId\r\n        });\r\n    }\r\n    if (!globalInitDone) {\r\n        // Steps here should only be done once per page: creation or wrapping\r\n        // of dataLayer and global gtag function.\r\n        // Detect if user has already put the gtag <script> tag on this page.\r\n        if (!findGtagScriptOnPage()) {\r\n            insertScriptTag(dataLayerName);\r\n        }\r\n        getOrCreateDataLayer(dataLayerName);\r\n        var _a = wrapOrCreateGtag(initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, dataLayerName, gtagName), wrappedGtag = _a.wrappedGtag, gtagCore = _a.gtagCore;\r\n        wrappedGtagFunction = wrappedGtag;\r\n        gtagCoreFunction = gtagCore;\r\n        globalInitDone = true;\r\n    }\r\n    // Async but non-blocking.\r\n    // This map reflects the completion state of all promises for each appId.\r\n    initializationPromisesMap[appId] = initializeIds(app, dynamicConfigPromisesList, measurementIdToAppId, installations, gtagCoreFunction);\r\n    var analyticsInstance = {\r\n        app: app,\r\n        // Public methods return void for API simplicity and to better match gtag,\r\n        // while internal implementations return promises.\r\n        logEvent: function (eventName, eventParams, options) {\r\n            logEvent(wrappedGtagFunction, initializationPromisesMap[appId], eventName, eventParams, options).catch(function (e) { return logger.error(e); });\r\n        },\r\n        setCurrentScreen: function (screenName, options) {\r\n            setCurrentScreen(wrappedGtagFunction, initializationPromisesMap[appId], screenName, options).catch(function (e) { return logger.error(e); });\r\n        },\r\n        setUserId: function (id, options) {\r\n            setUserId(wrappedGtagFunction, initializationPromisesMap[appId], id, options).catch(function (e) { return logger.error(e); });\r\n        },\r\n        setUserProperties: function (properties, options) {\r\n            setUserProperties(wrappedGtagFunction, initializationPromisesMap[appId], properties, options).catch(function (e) { return logger.error(e); });\r\n        },\r\n        setAnalyticsCollectionEnabled: function (enabled) {\r\n            setAnalyticsCollectionEnabled(initializationPromisesMap[appId], enabled).catch(function (e) { return logger.error(e); });\r\n        },\r\n        INTERNAL: {\r\n            delete: function () {\r\n                delete initializationPromisesMap[appId];\r\n                return Promise.resolve();\r\n            }\r\n        }\r\n    };\r\n    return analyticsInstance;\r\n}\n\nvar name = \"@firebase/analytics\";\nvar version = \"0.6.0\";\n\n/**\r\n * Type constant for Firebase Analytics.\r\n */\r\nvar ANALYTICS_TYPE = 'analytics';\r\nfunction registerAnalytics(instance) {\r\n    instance.INTERNAL.registerComponent(new Component(ANALYTICS_TYPE, function (container) {\r\n        // getImmediate for FirebaseApp will always succeed\r\n        var app = container.getProvider('app').getImmediate();\r\n        var installations = container\r\n            .getProvider('installations')\r\n            .getImmediate();\r\n        return factory(app, installations);\r\n    }, \"PUBLIC\" /* PUBLIC */).setServiceProps({\r\n        settings: settings,\r\n        EventName: EventName,\r\n        isSupported: isSupported\r\n    }));\r\n    instance.INTERNAL.registerComponent(new Component('analytics-internal', internalFactory, \"PRIVATE\" /* PRIVATE */));\r\n    instance.registerVersion(name, version);\r\n    function internalFactory(container) {\r\n        try {\r\n            var analytics = container.getProvider(ANALYTICS_TYPE).getImmediate();\r\n            return {\r\n                logEvent: analytics.logEvent\r\n            };\r\n        }\r\n        catch (e) {\r\n            throw ERROR_FACTORY.create(\"interop-component-reg-failed\" /* INTEROP_COMPONENT_REG_FAILED */, {\r\n                reason: e\r\n            });\r\n        }\r\n    }\r\n}\r\nregisterAnalytics(firebase);\r\n/**\r\n * this is a public static method provided to users that wraps four different checks:\r\n *\r\n * 1. check if it's not a browser extension environment.\r\n * 1. check if cookie is enabled in current browser.\r\n * 3. check if IndexedDB is supported by the browser environment.\r\n * 4. check if the current browser context is valid for using IndexedDB.\r\n *\r\n */\r\nfunction isSupported() {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var isDBOpenable, error_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    if (isBrowserExtension()) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (!areCookiesEnabled()) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (!isIndexedDBAvailable()) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, 3, , 4]);\r\n                    return [4 /*yield*/, validateIndexedDBOpenable()];\r\n                case 2:\r\n                    isDBOpenable = _a.sent();\r\n                    return [2 /*return*/, isDBOpenable];\r\n                case 3:\r\n                    error_1 = _a.sent();\r\n                    return [2 /*return*/, false];\r\n                case 4: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\n\nexport { factory, getGlobalVars, registerAnalytics, resetGlobalVars, settings };\n//# sourceMappingURL=index.esm.js.map\n"],"sourceRoot":""}